### [CVPR 2025] Flowing from Words to Pixels: A Noise-Free Framework for Cross-Modality Evolution [ğŸ—‚ï¸](https://arxiv.org/abs/2412.15213)


- Diffusion & Flow Matching
  - Diffusion
    - Gaussian noise > target data ë¶„í¬ë¡œì˜ ë§¤í•‘ í•™ìŠµ
    - Cross-modal (ì˜ˆ: Text-to-Image) ì—ì„œëŠ” í…ìŠ¤íŠ¸ê°€ ì¡°ê±´(condition)ìœ¼ë¡œ ì¶”ê°€ë¨ (ì£¼ë¡œ cross-attention í™œìš©)
  - Flow Matching
    - Diffusion ì˜ ì¼ë°˜í™” ë²„ì „ (ë” ë„“ì€ ê°œë…)
    - Noise ì—ì„œ target ìœ¼ë¡œ ê°€ëŠ” ë” ë‹¨ìˆœí•˜ê³  ìµœì í™”ëœ ê²½ë¡œ í•™ìŠµ
    - Source ë¶„í¬ê°€ ë°˜ë“œì‹œ noise ì¼ í•„ìš”ëŠ” ì—†ìŒ > target ê³¼ ìƒê´€ê´€ê³„ ìˆëŠ” ë‹¤ë¥¸ ë¶„í¬ (ì˜ˆ: text latent) ì‚¬ìš© ê°€ëŠ¥

- Background
  - RQ: Flow Matching ë°©ì‹ì„ ì‚¬ìš©í•´ Noise, Condition ì—†ì´ ì§ì ‘ modality ê°„ ë§¤í•‘ì´ ê°€ëŠ¥í• ê¹Œ?
  - (1) Shape Mismatch
    - Diffusion/Flow ëª¨ë¸ì€ source ì™€ target ë¶„í¬ì˜ shape ì´ ë™ì¼í•´ì•¼ í•¨
    - â¡ï¸ ì„œë¡œ ë‹¤ë¥¸ ëª¨ë‹¬ë¦¬í‹°(ì˜ˆ: í…ìŠ¤íŠ¸ vs ì´ë¯¸ì§€)ëŠ” êµ¬ì¡°ê°€ ë‹¬ë¼ì„œ ì§ì ‘ ë§¤í•‘ ë¶ˆê°€
  - (2) Classifier-Free Guidance(CFG) ì ìš© ë¶ˆê°€
    - ê¸°ì¡´ SOTA ëª¨ë¸ë“¤ì€ CFG ë¡œ ì„±ëŠ¥ í–¥ìƒ
    - Flow Matching ë°©ì‹ ì±„íƒ ì‹œ, ì¡°ê±´ ì •ë³´ê°€ source data ìì²´ì— í¬í•¨ë˜ì–´ ìˆìŒ
    - â¡ï¸ ê¸°ì¡´ CFG ë°©ì‹(ì¡°ê±´ on/off ì „í™˜) ì‚¬ìš© ë¶ˆê°€ëŠ¥

- Methods: Variational Encoder
  - ë¬¸ì œì 
    - Flow Matching ì€ source ë¶„í¬ì™€ target ë¶„í¬ê°€ ê°™ì€ shape ì´ì–´ì•¼ í•¨
    - ë‹¨ìˆœ Encoder ë¡œ ì§ì ‘ ë²¡í„° ì¸ì½”ë”© ì‹œ ì…ë ¥ ì •ë³´ë¥¼ ë³´ì¡´í•  ìˆ˜ëŠ” ìˆì§€ë§Œ flow matching í”„ë ˆì„ì›Œí¬ì—ì„œëŠ” ë¶ˆì•ˆì •
    - â¡ï¸ ì •ê·œí™”ëœ latent ë¶„í¬ê°€ í•„ìš”
  - í•´ê²°ì±…: Variational Encoder (VE)
    ```math
    z_0 \sim \mathcal{N}(\bar{\mu}_{z_0}, \bar{\sigma}_{z_0}^2)
    ```
    - ë‹¨ì¼ ë²¡í„°ë¥¼ ì…ë ¥í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, ë¶„í¬ì˜ í‰ê· ê³¼ ë¶„ì‚° ì˜ˆì¸¡ í›„ ì •ê·œí™”ëœ ë¶„í¬ì—ì„œ ìƒ˜í”Œ
  - í•™ìŠµë°©ì‹
    - Loss = Encoding Loss + KL Divergence Loss
    - ì¼ë°˜ VAE ì™€ ë‹¬ë¦¬ Decoder ëŠ” í•„ìš” ì—†ìŒ (Encoder ì—­í• ë§Œ ìˆ˜í–‰)

- Methods: Training CrossFlow
    ```math
    \begin{aligned}
    L &= L_{FM} + L_{Enc} + \lambda L_{KL} \\
      &= \mathrm{MSE}(v_\theta(z_t, t), \hat{v}) + \mathrm{Enc}(z_0, \hat{z}) \\
      &\quad + \lambda \mathrm{KL}(\mathcal{N}(\bar{\mu}_{z_0}, \bar{\sigma}_{z_0}^2) \parallel \mathcal{N}(0, 1))
    \end{aligned}
    ```
  - Flow Matching MSE Loss: ì˜¬ë°”ë¥¸ velocity ì˜ˆì¸¡
  - Encoding loss: task ì— ë”°ë¼ ìƒì´
  - KL Divergence: latent ë¶„í¬ë¥¼ N(0,1)ì— ê°€ê¹ê²Œ ì •ê·œí™”

- Arithmetic Operations in Latent Space
- Results: Text-to-Image Generation
- Results: Image Super-resolution
